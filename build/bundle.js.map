{"version":3,"sources":["webpack://appdev/webpack/universalModuleDefinition","webpack://appdev/webpack/bootstrap","webpack://appdev/./src/AppDevUtilities.js","webpack://appdev/external \"express\"","webpack://appdev/external \"babel-runtime/helpers/classCallCheck\"","webpack://appdev/external \"babel-runtime/helpers/createClass\"","webpack://appdev/external \"http\"","webpack://appdev/./src/AppDevAPI.js","webpack://appdev/external \"axios\"","webpack://appdev/external \"babel-runtime/core-js/object/keys\"","webpack://appdev/external \"babel-runtime/helpers/asyncToGenerator\"","webpack://appdev/external \"babel-runtime/regenerator\"","webpack://appdev/./src/AppDevRouter.js","webpack://appdev/./src/index.js"],"names":["root","factory","exports","module","define","amd","global","installedModules","__webpack_require__","moduleId","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","configurable","enumerable","get","r","value","n","__esModule","object","property","prototype","hasOwnProperty","p","w","s","googleAxios","default","create","baseURL","timeout","tryCheckAppDevURL","path","length","Error","encodeUrlParams","params","_keys2","map","k","encodeURIComponent","join","insertIntoMySQLStatement","tableName","fields","netIdFromEmail","email","substring","indexOf","require","AppDevAPI","_classCallCheck3","this","express","_express2","init","_AppDevUtilities2","getPath","middleware","routers","use","server","_http2","createServer","on","err","console","log","address","port","_express","AppDevResponse","success","data","AppDevRouter","type","router","Router","requestType","response","post","delete","req","_ref2","_this","_asyncToGenerator3","_regenerator2","mark","_callee2","res","next","content","wrap","_context2","prev","sent","json","t0","message","errors","stop","_x2","_x3","_x4","apply","arguments"],"mappings":"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","file":"bundle.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"appdev\"] = factory();\n\telse\n\t\troot[\"appdev\"] = factory();\n})(global, function() {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading wasm modules\n \tvar installedWasmModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// object with all compiled WebAssembly.Modules\n \t__webpack_require__.w = {};\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 12);\n","// @flow\n// General utility functions / Objects helpful in a JS setting across\n// all AppDev projects\nimport axios from 'axios';\n\n/**\n * Check if a string is an AppDev-formatted URL. An AppDev formatted URL is \n * either just a '/', or begins and ends with a `/`, and must have some \n * characters in between.\n */\nconst tryCheckAppDevURL = (path: string) => {\n  if (path !== '/' && path.length < 2) {\n    throw new Error('Invalid path!');\n  } else if (path[0] !== '/') {\n    throw new Error('Path must start with a \\'/\\'!');\n  } else if (path[path.length - 1] !== '/') {\n    throw new Error('Path must end with a \\'/\\'!');\n  }\n}\n\nconst encodeUrlParams = (params: { [string]: any }): string => {\n  return Object.keys(params).map((k: string) => {\n    return `${encodeURIComponent(k)}=${encodeURIComponent(params[k])}`;\n  }).join('&');\n};\n\nconst googleAxios = axios.create({\n  baseURL: 'https://www.googleapis.com',\n  timeout: 5000\n});\n\nconst insertIntoMySQLStatement = (\n  tableName: string,\n  fields: Object\n): string => {\n  const columns =\n    `(${Object.keys(fields).join(', ')})`;\n  const valuesStr =\n    Object.keys(fields).map(k => {\n      const value = fields[k];\n      return typeof value === 'string'\n        ? `'${fields[k]}'`\n        : `${fields[k]}`;\n    }).join(', ');\n  const values = `(${valuesStr})`;\n  return `INSERT INTO ${tableName} ${columns} VALUES ${values};`;\n};\n\nconst netIdFromEmail = (email: string): string => {\n  return email.substring(0, email.indexOf('@'));\n};\n\nexport default {\n  tryCheckAppDevURL,\n  encodeUrlParams,\n  googleAxios,\n  insertIntoMySQLStatement,\n  netIdFromEmail\n};\n","module.exports = require(\"express\");","module.exports = require(\"babel-runtime/helpers/classCallCheck\");","module.exports = require(\"babel-runtime/helpers/createClass\");","module.exports = require(\"http\");","// @flow\r\n\r\nimport http from 'http'\r\nimport express, {Application, Router, Request, Response, NextFunction} from 'express';\r\nimport AppDevUtilities from './AppDevUtilities';\r\n\r\n/**\r\n * ExpressHandlerFunction - the function signature of callbacks for Express\r\n * Router objects\r\n */\r\nexport type ExpressCallback = (Request, Response, NextFunction) => any;\r\n\r\n/**\r\n * AppDevAPI - create an Express Application object from a series of middleware\r\n * and routers\r\n *\r\n * Subclasses can specify the middleware and routers required for implementing\r\n * the backend's API. This pattern is cleaner than than raw Express Application\r\n * initialization with middleware functions and routers.\r\n */\r\nclass AppDevAPI {\r\n  \r\n  express: Application;\r\n\r\n  /**\r\n   * Subclasses must call this constructor to set up the API\r\n   */\r\n  constructor() {\r\n    this.express = express();\r\n    this.init();\r\n  }\r\n\r\n  /**\r\n   * Initialize the Express Application object using the middleware\r\n   * and routers provided by the subclass.\r\n   */\r\n  init() {\r\n    AppDevUtilities.tryCheckAppDevURL(this.getPath());\r\n    let middleware = this.middleware();\r\n    let routers = this.routers();\r\n\r\n    for (let i = 0; i < middleware.length; i++) {\r\n      this.express.use(middleware[i]);\r\n    }\r\n\r\n    for (let i = 0; i < routers.length; i++) {\r\n      this.express.use(this.getPath(), routers[i]);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Subclasses must override this with the API's URL. Paths must\r\n   * be an AppDev-formatted URL.\r\n   */\r\n  getPath(): string {\r\n    return '/';\r\n  }\r\n\r\n  /**\r\n   * Subclasses must override this to supply middleware for the API.\r\n   */\r\n  preMiddleware(): Array<any> {\r\n    return [];\r\n  }\r\n\r\n  /**\r\n   * Subclasses must override this to supply middleware for the API.\r\n   */\r\n  routers(): Array<Router> {\r\n    return [];\r\n  }\r\n\r\n  /**\r\n   * Subclasses must override this to supply middleware for the API.\r\n   */\r\n  preMiddleware(): Array<any> {\r\n    return [];\r\n  }\r\n\r\n  /**\r\n   * Get an HTTP server backed by the Express Application\r\n   */\r\n  getServer(): http.Server {\r\n    const server: http.Server = http.createServer(this.express);\r\n    const onError = (err: Error): void => {\r\n      console.log(err);\r\n    };\r\n\r\n    const onListening = (): void => {\r\n      let address = server.address().address;\r\n      let port = server.address().port;\r\n      console.log(`Listening on ${address}:${port}`);\r\n    };\r\n\r\n    server.on('error', onError);\r\n    server.on('listening', onListening);\r\n    return server;\r\n  }\r\n\r\n}\r\n\r\nexport default AppDevAPI;","module.exports = require(\"axios\");","module.exports = require(\"babel-runtime/core-js/object/keys\");","module.exports = require(\"babel-runtime/helpers/asyncToGenerator\");","module.exports = require(\"babel-runtime/regenerator\");","// @flow\n\nimport AppDevUtilities from './AppDevUtilities';\nimport { Router, Request, Response, NextFunction } from 'express';\n\n/**\n * RequestType - the HTTP methods supported by AppDevRouter\n */\nexport type RequestType = 'GET' | 'POST' | 'DELETE';\n\n/**\n * AppDevResponse - the response from an HTTP request\n * \n * Wraps a `success` field around the response data\n */\nclass AppDevResponse<T> {\n  success: boolean;\n  data: T;\n\n  constructor (success: boolean, data: T) {\n    this.success = success;\n    this.data = data;\n  }\n}\n\n/**\n * AppDevRouter - cleanly create an Express Router object using inheritance\n *\n * Subclasses can simply specify the HTTP method, the path, and a response \n * hook to compute response data. This pattern is cleaner than raw Express \n * Router initialization with callbacks.\n */\nclass AppDevRouter<T> {\n  router: Router;\n  requestType: RequestType;\n\n  /**\n   * Subclasses must call this constructor and pass in the HTTP method\n   */\n  constructor(type: RequestType) {\n    this.router = new Router();\n    this.requestType = type;\n\n    // Initialize this router\n    this.init();\n  }\n\n  /**\n   * Initialize the Express Router using the specified path and response hook\n   * implementation.\n   */\n  init() {\n    const path = this.getPath();\n\n    // Make sure path conforms to specification\n    AppDevUtilities.tryCheckAppDevURL(path);\n\n    // Attach content to router\n    switch (this.requestType) {\n    case 'GET':\n      this.router.get(path, this.response());\n      break;\n    case 'POST':\n      this.router.post(path, this.response());\n      break;\n    case 'DELETE':\n      this.router.delete(path, this.response());\n      break;\n    default:\n      throw new Error(\"HTTP method not specified!\");\n    }\n  }\n\n  /**\n   * Subclasses must override this with the endpoint's URL. Paths must\n   * be an AppDev-formatted URL\n   */\n  getPath(): string {\n    throw new Error('You must implement getPath() with a valid path!');\n  }\n\n  /**\n   * Subclasses must override this response hook to generate response data\n   * for the given request.\n   */\n  async content (req: Request): Promise<T> {\n    throw new Error(1);\n  }\n\n  /**\n   * Create a wrapper around the response hook to pass to the Express\n   * Router. \n   */\n  response() {\n    return async (req: Request, res: Response, next: NextFunction) => {\n      try {\n        const content = await this.content(req);\n        res.json(new AppDevResponse(true, content));\n      } catch (e) {\n        if (e.message === 1) {\n          throw new Error('You must implement content()!');\n        } else {\n          res.json(new AppDevResponse(false, {errors: [e.message]}));\n        }\n      }\n      next();\n    }\n  } \n\n  \n}\n\nexport default AppDevRouter;\n","// @flow\nexport { default as AppDevRouter} from './AppDevRouter';\nexport { default as AppDevAPI }  from './AppDevAPI';\nexport { default as AppDevUtilities} from './AppDevUtilities';\n"],"sourceRoot":""}